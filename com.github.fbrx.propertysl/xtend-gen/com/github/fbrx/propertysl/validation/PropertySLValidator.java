/**
 * generated by Xtext
 */
package com.github.fbrx.propertysl.validation;

import com.github.fbrx.propertysl.propertySL.ComplexPropertyValueItem;
import com.github.fbrx.propertysl.propertySL.DefaultableLocale;
import com.github.fbrx.propertysl.propertySL.PropertySLPackage.Literals;
import com.github.fbrx.propertysl.propertySL.SupportedLocales;
import com.github.fbrx.propertysl.validation.AbstractPropertySLValidator;
import org.eclipse.emf.common.util.EList;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.xtext.validation.Check;

/**
 * Custom validation rules.
 * 
 * see http://www.eclipse.org/Xtext/documentation.html#validation
 */
@SuppressWarnings("all")
public class PropertySLValidator extends AbstractPropertySLValidator {
  public final static String MISSING_LOCALES = "MISSING_LOCALES";
  
  public final static String DEFAULT_LOCALE_NOT_SET = "DEFAULT_LOCALE_NOT_SET";
  
  public final static String LOCALE_NOT_SUPPORTED = "UNDEFINED_LOCALE";
  
  @Check
  public void checkIfDefaultLocaleIsSet(final SupportedLocales sl) {
    EList<DefaultableLocale> _locales = sl.getLocales();
    int _size = _locales.size();
    boolean _greaterThan = (_size > 1);
    if (_greaterThan) {
      boolean defaultSet = false;
      EList<DefaultableLocale> _locales_1 = sl.getLocales();
      for (final DefaultableLocale dl : _locales_1) {
        boolean _isIsDefault = dl.isIsDefault();
        if (_isIsDefault) {
          defaultSet = true;
        }
      }
      boolean _not = (!defaultSet);
      if (_not) {
        this.warning("Default locale should be specified.", Literals.SUPPORTED_LOCALES__LOCALES, PropertySLValidator.DEFAULT_LOCALE_NOT_SET);
      }
    }
  }
  
  @Check
  public void checkLocaleOfComplexPropertyValue(final ComplexPropertyValueItem item) {
    EObject _eContainer = item.eContainer();
    EObject _eContainer_1 = _eContainer.eContainer();
    EObject _eContainer_2 = _eContainer_1.eContainer();
    final com.github.fbrx.propertysl.propertySL.Package pkg = ((com.github.fbrx.propertysl.propertySL.Package) _eContainer_2);
    boolean foundLocale = false;
    SupportedLocales _supportedLocales = pkg.getSupportedLocales();
    EList<DefaultableLocale> _locales = _supportedLocales.getLocales();
    for (final DefaultableLocale dl : _locales) {
      String _lang = dl.getLang();
      String _lang_1 = item.getLang();
      boolean _equals = _lang.equals(_lang_1);
      if (_equals) {
        foundLocale = true;
      }
    }
    boolean _not = (!foundLocale);
    if (_not) {
      String _lang_2 = item.getLang();
      String _plus = ("Locale \"" + _lang_2);
      String _plus_1 = (_plus + "\" is not supported.");
      String _lang_3 = item.getLang();
      this.warning(_plus_1, Literals.COMPLEX_PROPERTY_VALUE_ITEM__LANG, PropertySLValidator.LOCALE_NOT_SUPPORTED, _lang_3);
    }
  }
}
